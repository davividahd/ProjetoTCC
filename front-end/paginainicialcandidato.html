<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./CSS/style.css" type="text/css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="./CSS/navega√ßao.css">
    <link rel="icon" type="image/x-icon" href="./CSS/imagens/iconedosite.png">
    <title>Vagas Dispon√≠veis</title>
</head>
<body>
    <header>
        <div class="borda"></div>
        <ul>
            <li class="drop">
                <button class="botaodrop" style="height: 50px; width: 60px;">
                    <img style="height: 20px; width: 30px;" src="./CSS/imagens/tracos.png" alt="Menu">
                </button>
                <div class="dropconteudo">
                    <div style="height: 40px;"></div>
                    <a href="./verperfil.html">Ver Perfil</a>
                    <a href="">Feed</a>
                    <a href="">Procurar Vagas</a>
                    <a href="./mensagens.html">Mensagens</a>
                    <a href="./contatos.html">Notifica√ß√µes</a>
                    <a href="">Configura√ß√µes</a>
                </div>
            </li>
            
            <img style="float: left; height: 90px; width: 90px; border-radius: 250px; margin-left: 20px; margin-top: 20px;" src="./CSS/imagens/iconedosite.png">
            <li><a class="botaocriar" href="criarconta.html">Criar Conta</a></li>
            <li><input class="pesquisa" type="text" id="search-input" placeholder="Pesquisar"></li>
            <li><button class="btn btn-secondary" id="toggle-dark-mode" style="height: 40px; width: 40px; border-radius: 50%; background-color: #333; color: #fff; border: none; font-size: 18px;">üåô</button></li>
        </ul>
    </header>

    <section>
        <div class="carrossel">
            <div class="slides">
                <img src="https://images.stockcake.com/public/b/1/7/b1714ff0-03bb-405d-a4a6-7b43efeb3c33_large/coding-late-night-stockcake.jpg" alt="img1">
                <img src="https://blog.unoeste.br/wp-content/uploads/2021/05/faculdade-engenharia-civil.jpg" alt="img2">
                <img src="https://lh5.googleusercontent.com/Gy4G-1-wIEJKYSmW2E0mHT2jpA2VCn1KdkNe_tTm5-gnsheJV3XtfCVV1_T_CKz1oYhGgxn9YYoB9jD21Ro9mHnQa8LgeNUK_9JQem7kX-thxcGBJkzqATKcmLLEvV8gCTSqBmls" alt="img3">
                <img src="https://tse3.mm.bing.net/th/id/OIP.M8L3qm6wJES7jmTh_khBngHaE8?w=1221&h=815&rs=1&pid=ImgDetMain&o=7&rm=3" alt="img4">
            </div>
        </div>
    </section>
    
    <section class="vaga-container py-5">
        <div class="container">
            <h2 class="textovagas">Vagas Dispon√≠veis</h2>

            <!-- Filtros de Vagas -->
            <div class="row mb-4">
                <div class="col-md-4">
                    <input type="text" class="form-control" id="search-cargo" placeholder="Buscar por cargo ou empresa">
                </div>
                <div class="col-md-4">
                    <select class="form-select" id="search-localizacao" title="Selecione uma localiza√ß√£o" aria-label="Selecione uma localiza√ß√£o">
                        <option selected>Selecione uma localiza√ß√£o</option>
                        <option value="S√£o Paulo">S√£o Paulo</option>
                        <option value="Rio de Janeiro">Rio de Janeiro</option>
                        <option value="Belo Horizonte">Belo Horizonte</option>
                        <option value="Curitiba">Curitiba</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <select class="form-select" id="search-tipo">
                        <option selected>Filtrar por tipo de trabalho</option>
                        <option value="Tempo Integral">Tempo Integral</option>
                        <option value="Meio Per√≠odo">Meio Per√≠odo</option>
                        <option value="Freelancer">Freelancer</option>
                    </select>
                </div>
            </div>

            <!-- Cards de Vagas -->
            <div class="row g-4" id="vaga-container">
                <!-- Os cards ser√£o adicionados automaticamente aqui --> 
            </div>
        </div>
    </section>

    <footer>
        <div class="rodape">
            <p>&copy; 2025 FusionDevs. Todos os direitos reservados.</p>
            <p>Informa√ß√µes de contato: <a href="mailto:contato@suaempresa.com">contato@suaempresa.com</a></p>
            <div class="modal fade" id="modalDetalhes" tabindex="-1" aria-labelledby="modalDetalhesLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="modalDetalhesLabel">Detalhes da Vaga</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <img id="modal-imagem" class="img-fluid" alt="Imagem Vaga">
                                </div>
                                <div class="col-md-6">
                                    <h5 id="modal-titulo"></h5>
                                    <p><strong>Descri√ß√£o:</strong> <span id="modal-descricao"></span></p>
                                    <p><strong>Localiza√ß√£o:</strong> <span id="modal-localizacao"></span></p>
                                    <p><strong>Tipo de Trabalho:</strong> <span id="modal-tipo"></span></p>
                                    <p><strong>Contato:</strong> <span id="modal-contato">contato@suaempresa.com</span></p>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                            <button type="button" class="btn btn-primary">Candidatar-se</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="links">
                <a href="/politica-de-privacidade">Pol√≠tica de Privacidade</a>
                <span>|</span>
                <a href="/termos-de-servico">Termos de Servi√ßo</a>
            </div>

            <div class="social-media">
                <a href="https://www.facebook.com/FusionDevs" target="_blank" class="social-icon">
                    <img src="https://img.icons8.com/ios-filled/50/ffffff/facebook.png" alt="Facebook"/>
                </a>
                <a href="https://twitter.com/FusionDevs" target="_blank" class="social-icon">
                    <img src="https://img.icons8.com/ios-filled/50/ffffff/twitter.png" alt="Twitter"/>
                </a>
                <a href="https://www.linkedin.com/company/fusiondevs" target="_blank" class="social-icon">
                    <img src="https://img.icons8.com/ios-filled/50/ffffff/linkedin.png" alt="LinkedIn"/>
                </a>
                <a href="https://www.instagram.com/FusionDevs" target="_blank" class="social-icon">
                    <img src="https://img.icons8.com/ios-filled/50/ffffff/instagram.png" alt="Instagram"/>
                </a>
            </div>

            <div class="developer-info">
                <p>Desenvolvido por <a href="https://www.fusiondevs.com" target="_blank">FusionDevs</a></p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>

    <script>
document.addEventListener("DOMContentLoaded", () => {
    const API_URL = "https://faithful-spirit-teste1.up.railway.app/tcc/busca_Vaga";
    const container = document.getElementById("vaga-container");
    let vagas = [];

    async function carregarVagas() {
        try {
            const response = await fetch(API_URL);
            if (!response.ok) throw new Error("Erro ao buscar vagas do servidor.");

            const data = await response.json();

            if (!Array.isArray(data) || data.length === 0) {
                container.innerHTML = `<p style="color:red; font-weight:bold;">Nenhuma vaga cadastrada no sistema.</p>`;
                return;
            }

            vagas = data.map(v => ({
                id: v.id_vaga,
                titulo: v.nome,
                preco: v.preco,
                categoria: v.id_categoria,
                empresa: v.id_empresa,
                is_pcd: v.is_pcd,
                imagem: "https://cdn-icons-png.flaticon.com/512/609/609803.png",
                descricao: "Informa√ß√µes adicionais n√£o fornecidas.",
                localizacao: "N√£o informada",
                tipoTrabalho: "Tempo Integral"
            }));

            criarCards(vagas);
        } catch (erro) {
            console.error("Erro:", erro);
            container.innerHTML = `<p style="color:red;">Falha ao conectar com o servidor.</p>`;
        }
    }

    function criarCards(lista) {
        container.innerHTML = "";

        lista.forEach((vaga, index) => {
            const card = document.createElement("div");
            card.classList.add("col-md-4", "mb-4");

            card.innerHTML = `
                <div class="card shadow-sm">
                    <img src="${vaga.imagem}" class="card-img-top" alt="Imagem da vaga">
                    <div class="card-body">
                        <h5 class="card-title">${vaga.titulo}</h5>
                        <p><strong>Categoria:</strong> ${vaga.categoria}</p>
                        <p><strong>Empresa:</strong> ${vaga.empresa}</p>
                        <p><strong>Sal√°rio:</strong> R$ ${vaga.preco}</p>
                        ${vaga.is_pcd ? '<span class="badge bg-success">PCD</span>' : ''}
                        <button class="btn btn-primary mt-2" data-index="${index}">Detalhes</button>
                    </div>
                </div>
            `;

            container.appendChild(card);
        });

        // adiciona eventos de clique para abrir modal
        container.querySelectorAll("button[data-index]").forEach(btn => {
            btn.addEventListener("click", e => {
                const i = e.target.getAttribute("data-index");
                mostrarDetalhesVaga(i);
            });
        });
    }

    function mostrarDetalhesVaga(index) {
        const vaga = vagas[index];
        document.getElementById("modal-titulo").innerText = vaga.titulo;
        document.getElementById("modal-imagem").src = vaga.imagem;
        document.getElementById("modal-descricao").innerText = vaga.descricao;
        document.getElementById("modal-localizacao").innerText = vaga.localizacao;
        document.getElementById("modal-tipo").innerText = vaga.tipoTrabalho;
        document.getElementById("modal-contato").innerText = `Empresa ID: ${vaga.empresa}`;

        const modal = new bootstrap.Modal(document.getElementById("modalDetalhes"));
        modal.show();
    }

    // Filtros
    function aplicarFiltros() {
        const buscaCargo = document.getElementById("search-cargo").value.toLowerCase();
        const localizacao = document.getElementById("search-localizacao").value;
        const tipoTrabalho = document.getElementById("search-tipo").value;

        const filtradas = vagas.filter(v => {
            const correspondeBusca = v.titulo.toLowerCase().includes(buscaCargo);
            const correspondeLocal = localizacao === "Selecione uma localiza√ß√£o" || v.localizacao.includes(localizacao);
            const correspondeTipo = tipoTrabalho === "Filtrar por tipo de trabalho" || v.tipoTrabalho === tipoTrabalho;
            return correspondeBusca && correspondeLocal && correspondeTipo;
        });

        criarCards(filtradas);
    }

    // Escuta mudan√ßas de filtros
    document.getElementById("search-cargo").addEventListener("input", aplicarFiltros);
    document.getElementById("search-localizacao").addEventListener("change", aplicarFiltros);
    document.getElementById("search-tipo").addEventListener("change", aplicarFiltros);

    // carrega as vagas
    carregarVagas();
});
</script>


    <!-- Script para o modo escuro -->
    <script src="./js/darkmode.js"></script>
</body>
</html>
