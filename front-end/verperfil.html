<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./CSS/Style.css" type="text/css">
    <link rel="stylesheet" href="./CSS/navega√ßao.css">
    <link rel="icon" type="image/x-icon" href="./CSS/imagens/iconedosite.png">
    <title>Ver Perfil</title>
</head>

<body style="background:linear-gradient(90deg,rgba(219, 29, 29, 1) 0%, rgba(255, 59, 59, 1) 100%, rgba(218, 34, 32, 1) 38%);">

    <!-- MENU LATERAL -->
    <ul class="voltar" style="background-color: rgb(252, 98, 98); margin: 20px; width: 98%; box-shadow: 10px 10px 20px rgb(29, 8, 8);">
        <li class="drop">
            <button class="botaodrop" style="height: 50px; width: 60px;">
                <img style="height: 20px; width: 30px;" src="./CSS/imagens/tracos.png">
            </button>
            <div class="dropconteudo">
                <div style="height: 40px;"></div>

                <!-- Links para candidato -->
                <a href="./paginainicialcandidato.html" class="nav-candidato">Inicio</a>
                <a href="" class="nav-candidato">Feed</a>
                <a href="" class="nav-candidato">Procurar Vagas</a>
                <a href="./mensagens.html" class="nav-candidato">Mensagens</a>

                <!-- Links para empresa -->
                <a href="./paginainicialempresa.html" class="nav-empresa">Inicio (Empresa)</a>
                <a href="./criarvaga.html" class="nav-empresa">Criar Vaga</a>
                <a href="./minhasvagas.html" class="nav-empresa">Minhas Vagas</a>

                <!-- Links em comum -->
                <a href="./contatos.html">Notifica√ß√µes</a>
                <a href="">Configura√ß√µes</a>
                <a id="btnLogout" style="cursor:pointer; color:white;">Sair</a>
            </div>
        </li>
    </ul>

    <!-- PERFIL -->
    <div class="fundo" style="margin-bottom: 100px;">
        <div class="perfil">

            <h1 id="tituloPerfil" style="font-size: 40px; color: white;">Perfil</h1>

            <!-- PERFIL DO CANDIDATO -->
            <div id="perfilCandidato" class="blocodevisualizar" style="display:none;">
                

                <div class="visualizar">
                    <p><strong>Nome:</strong> <span id="c_nome">‚Äî</span></p>
                    <p><strong>Email:</strong> <span id="c_email">‚Äî</span></p>
                    <p><strong>Telefone:</strong> <span id="c_telefone">‚Äî</span></p>
                    <p><strong>CPF:</strong> <span id="c_cpf">‚Äî</span></p>
                    <p><strong>√Årea de Trabalho:</strong> <span id="c_area">‚Äî</span></p>
                    <p><strong>PCD:</strong> <span id="c_pcd">‚Äî</span></p>
                    <p><strong>Limite Di√°rio:</strong> <span id="c_limite">‚Äî</span></p>
                    
                    <h3>Endere√ßo</h3>
                    <p><span id="c_endereco">‚Äî</span></p>
                </div>

                
                <div class="botaoverperfil">
                    <button style="background-color: rgb(255, 44, 44);">Visualizar Curr√≠culo</button>
                    <button id="btnEditar" style="background-color: rgb(255, 44, 44);">
                        Editar
                    </button>
                </div>

            </div>

            <!-- PERFIL DA EMPRESA -->
            <div id="perfilEmpresa" class="blocodevisualizar" style="display:none;">
                <div class="icone" style="margin-right: 180px;">
                    <img class="fotoicone1" src="./CSS/imagens/perfil.jpg">
                </div>

                <div class="visualizar">
                    <p><strong>Nome da Empresa:</strong> <span id="e_nome">‚Äî</span></p>
                    <p><strong>Email:</strong> <span id="e_email">‚Äî</span></p>
                    <p><strong>CNPJ:</strong> <span id="e_cnpj">‚Äî</span></p>
                    <p><strong>Cidade:</strong> <span id="e_cidade">‚Äî</span></p>
                    <p><strong>Estado:</strong> <span id="e_estado">‚Äî</span></p>
                </div>

                <div class="botaoverperfil">
                    <button style="background-color: rgb(255, 44, 44);">Ver Vagas</button>
                    <button onclick="window.location.href='./editarperfil.html'" style="background-color: rgb(255, 44, 44);">
                        Editar
                    </button>
                </div>
            </div>

        </div>
    </div>

    <footer>
        <div class="rodape">
            <p>&copy; 2025 FusionDevs. Todos os direitos reservados.</p>

            <div class="links">
                <a href="/politica-de-privacidade">Pol√≠tica de Privacidade</a>
                <span>|</span>
                <a href="/termos-de-servico">Termos de Servi√ßo</a>
            </div>

            <div class="social-media">
                <a href="#" class="social-icon"><img src="https://img.icons8.com/ios-filled/50/ffffff/facebook.png"></a>
                <a href="#" class="social-icon"><img src="https://img.icons8.com/ios-filled/50/ffffff/twitter.png"></a>
                <a href="#" class="social-icon"><img src="https://img.icons8.com/ios-filled/50/ffffff/linkedin.png"></a>
                <a href="#" class="social-icon"><img src="https://img.icons8.com/ios-filled/50/ffffff/instagram.png"></a>
            </div>
        </div>
    </footer>

    <!-- =============================== -->
    <!-- SCRIPT EMBUTIDO DO PERFIL -->
    <!-- =============================== -->
    <script>
document.addEventListener("DOMContentLoaded", () => {

    // Recupera o que foi salvo no login
    const usuario = JSON.parse(localStorage.getItem("usuario"));
    const tipo = localStorage.getItem("tipoUsuario") || 
                 document.referrer.includes("empresa") ? "empresa" : "candidato";

    if (!usuario) {
        alert("Nenhum usu√°rio logado!");
        window.location.href = "login.html";
        return;
    }

    // Configura o t√≠tulo
    document.getElementById("tituloPerfil").innerText =
        tipo === "empresa" ? "Perfil da Empresa" : "Perfil do Candidato";

    // Mostra os menus certos
    document.querySelectorAll(".nav-candidato")
        .forEach(el => el.style.display = tipo === "candidato" ? "block" : "none");

    document.querySelectorAll(".nav-empresa")
        .forEach(el => el.style.display = tipo === "empresa" ? "block" : "none");

    // ======================================================
    //              üìå   PERFIL DE CANDIDATO
    // ======================================================
    if (tipo === "candidato") {

        document.getElementById("perfilCandidato").style.display = "flex";

        document.getElementById("c_nome").innerText = usuario.nome_completo;
        document.getElementById("c_email").innerText = usuario.email;
        document.getElementById("c_telefone").innerText = usuario.telefone;
        document.getElementById("c_cpf").innerText = usuario.cpf;
        document.getElementById("c_limite").innerText = usuario.limite;
        document.getElementById("c_pcd").innerText = usuario.is_pcd ? "Sim" : "N√£o";

        // Como o backend N√ÉO envia nome da √°rea, apenas id_status
        document.getElementById("c_area").innerText = "√Årea ID: " + usuario.id_status;

        // Como o backend n√£o devolve logradouro, s√≥ o id_endereco
        document.getElementById("c_endereco").innerText =
            "Endere√ßo cadastrado (ID): " + usuario.id_endereco;
    }

    // ======================================================
    //              üìå   PERFIL DE EMPRESA
    // ======================================================
    if (tipo === "empresa") {

        document.getElementById("perfilEmpresa").style.display = "flex";

        document.getElementById("e_nome").innerText = usuario.nome;
        document.getElementById("e_email").innerText = usuario.email;
        document.getElementById("e_cnpj").innerText = usuario.cnpj;

        document.getElementById("e_cidade").innerText = usuario.cidade || "‚Äî";
        document.getElementById("e_estado").innerText = usuario.estado || "‚Äî";
    }

    // Bot√£o de Logout
    document.getElementById("btnLogout").addEventListener("click", () => {
        localStorage.clear();
        window.location.href = "login.html";
    });
});

const btnEditar = document.getElementById("btnEditar");
    let editando = false;

    btnEditar.addEventListener("click", () => {
        const container = document.getElementById("perfilCandidato");
        if (!container) return;

        if (!editando) {
            // Modo edi√ß√£o
            container.querySelectorAll("span").forEach(span => {
                const valor = span.textContent === "‚Äî" ? "" : span.textContent;
                const input = document.createElement("input");
                input.type = "text";
                input.value = valor;
                input.style.width = "200px";
                span.replaceWith(input);
            });
            btnEditar.textContent = "Salvar";
            editando = true;
        } else {
            // Salvar altera√ß√µes
            container.querySelectorAll("input").forEach(input => {
                const span = document.createElement("span");
                span.textContent = input.value || "‚Äî";
                input.replaceWith(span);
            });
            btnEditar.textContent = "Editar";
            editando = false;
        }
    });

</script>


</body>

</html>
